import{r as x,m as g,g as k,h as f,i as u,b as t,u as a,j as N,t as m,l as h,d as p,p as S,q as v,v as y,c,s as T,f as i}from"./app-uPr9ithl.js";import{B}from"./BeLayout-D1CglItS.js";import{G as V}from"./GetLocationButton-srKxCTfv.js";import{_ as D}from"./Includes-BtRLMiHA.js";const J={class:"d-flex justify-content-between align-items-center mb-3"},O={class:"fw-400"},P={class:"card-body"},j={class:"mb-3"},C={class:"mb-3"},E={class:"mb-3"},G={key:0,class:"small text-muted"},I={class:"d-flex justify-content-end"},L=["disabled"],M={key:0},U={key:1},A={__name:"Create",props:{formType:String,formTypes:Array},setup(r){const l=r,n=x(`{
  "example_key": "value"
}`),s=g({latitude:null,longitude:null,device_id:null,payload:{}}),b=o=>{s.latitude=o.latitude,s.longitude=o.longitude},_=()=>{let o={};try{o=JSON.parse(n.value||"{}")}catch{return alert("Invalid JSON in raw payload area"),null}return l.formType==="household"?o._meta={type:"household",version:1}:l.formType==="market"?o._meta={type:"market",version:1}:l.formType==="commercial_farm"&&(o._meta={type:"commercial_farm",version:1}),o},w=()=>{const o=_();o&&(s.payload=o,s.post(route("enumerations.store",l.formType)))};return(o,e)=>(i(),k(B,null,{default:f(()=>[u(a(N),{title:`New ${r.formType.replace("_"," ")} Enumeration`},null,8,["title"]),t("div",J,[t("h5",O,"New "+m(r.formType.replace("_"," "))+" Enumeration",1),u(a(h),{href:o.route("enumerations.index"),class:"btn btn-sm btn-outline-secondary"},{default:f(()=>[...e[2]||(e[2]=[t("i",{class:"bi bi-arrow-left"},null,-1),p(" Back",-1)])]),_:1},8,["href"])]),e[7]||(e[7]=t("hr",null,null,-1)),e[8]||(e[8]=t("div",{class:"alert alert-info small"}," Auth user & enumerator details are injected server-side. Provide survey data below (or paste full JSON from mobile client). Geolocation is optional but recommended. ",-1)),t("form",{onSubmit:S(w,["prevent"]),class:"card"},[t("div",P,[t("div",j,[e[3]||(e[3]=t("label",{class:"form-label"},"Device ID (optional)",-1)),v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=d=>a(s).device_id=d),type:"text",class:"form-control",placeholder:"Device identifier"},null,512),[[y,a(s).device_id]])]),t("div",C,[e[4]||(e[4]=t("label",{class:"form-label"},"Raw Payload (JSON)",-1)),v(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=d=>n.value=d),rows:"10",class:"form-control font-monospace"},null,512),[[y,n.value]]),e[5]||(e[5]=t("div",{class:"form-text"},"Paste or edit survey JSON. Minimal _meta will be auto-added.",-1))]),t("div",E,[u(V,{onUpdated:b}),a(s).latitude&&a(s).longitude?(i(),c("div",G," Will store: "+m(a(s).latitude)+", "+m(a(s).longitude),1)):T("",!0)]),t("div",I,[t("button",{class:"btn btn-success",disabled:a(s).processing},[a(s).processing?(i(),c("span",U,"Saving...")):(i(),c("span",M,[...e[6]||(e[6]=[t("i",{class:"bi bi-save"},null,-1),p(" Save Record",-1)])]))],8,L)])])],32)]),_:1}))}},$=D(A,[["__scopeId","data-v-1c763f77"]]);export{$ as default};
