import{r as b,o as U,w as H,c as V,a as t,b as A,d as k,e as $,n as x,u,l as R,F as P,f as M,t as p,g as y,h as I,i as L,j as C,k as B,m as G}from"./app-Czn7CuL3.js";import{B as q}from"./BeLayout-BEIOWfhc.js";import{_ as O}from"./Includes-CkR_m-ys.js";var D=function(){return D=Object.assign||function(c){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(c[s]=e[s]);return c},D.apply(this,arguments)},N=(function(){function c(e,n,i){var s=this;this.endVal=n,this.options=i,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(l){s.startTime||(s.startTime=l);var d=l-s.startTime;s.remaining=s.duration-d,s.useEasing?s.countDown?s.frameVal=s.startVal-s.easingFn(d,0,s.startVal-s.endVal,s.duration):s.frameVal=s.easingFn(d,s.startVal,s.endVal-s.startVal,s.duration):s.frameVal=s.startVal+(s.endVal-s.startVal)*(d/s.duration);var a=s.countDown?s.frameVal<s.endVal:s.frameVal>s.endVal;s.frameVal=a?s.endVal:s.frameVal,s.frameVal=Number(s.frameVal.toFixed(s.options.decimalPlaces)),s.printValue(s.frameVal),d<s.duration?s.rAF=requestAnimationFrame(s.count):s.finalEndVal!==null?s.update(s.finalEndVal):s.options.onCompleteCallback&&s.options.onCompleteCallback()},this.formatNumber=function(l){var d,a,r,f,h=l<0?"-":"";d=Math.abs(l).toFixed(s.options.decimalPlaces);var m=(d+="").split(".");if(a=m[0],r=m.length>1?s.options.decimal+m[1]:"",s.options.useGrouping){f="";for(var g=3,o=0,w=0,S=a.length;w<S;++w)s.options.useIndianSeparators&&w===4&&(g=2,o=1),w!==0&&o%g==0&&(f=s.options.separator+f),o++,f=a[S-w-1]+f;a=f}return s.options.numerals&&s.options.numerals.length&&(a=a.replace(/[0-9]/g,(function(_){return s.options.numerals[+_]})),r=r.replace(/[0-9]/g,(function(_){return s.options.numerals[+_]}))),h+s.options.prefix+a+r+s.options.suffix},this.easeOutExpo=function(l,d,a,r){return a*(1-Math.pow(2,-10*l/r))*1024/1023+d},this.options=D(D({},this.defaults),i),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof e=="string"?document.getElementById(e):e,n=n??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(n),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,e):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push((function(){return s.handleScroll(s)})),window.onscroll=function(){window.onScrollFns.forEach((function(l){return l()}))},this.handleScroll(this)))}return c.prototype.handleScroll=function(e){if(e&&window&&!e.once){var n=window.innerHeight+window.scrollY,i=e.el.getBoundingClientRect(),s=i.top+window.pageYOffset,l=i.top+i.height+window.pageYOffset;l<n&&l>window.scrollY&&e.paused?(e.paused=!1,setTimeout((function(){return e.start()}),e.options.scrollSpyDelay),e.options.scrollSpyOnce&&(e.once=!0)):(window.scrollY>l||s>n)&&!e.paused&&e.reset()}},c.prototype.determineDirectionAndSmartEasing=function(){var e=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>e;var n=e-this.startVal;if(Math.abs(n)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=e;var i=this.countDown?1:-1;this.endVal=e+i*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=e,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},c.prototype.start=function(e){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),e&&(this.options.onCompleteCallback=e),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},c.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},c.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},c.prototype.update=function(e){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(e),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},c.prototype.printValue=function(e){var n;if(this.el){var i=this.formattingFn(e);!((n=this.options.plugin)===null||n===void 0)&&n.render?this.options.plugin.render(this.el,i):this.el.tagName==="INPUT"?this.el.value=i:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=i:this.el.innerHTML=i}},c.prototype.ensureNumber=function(e){return typeof e=="number"&&!isNaN(e)},c.prototype.validateValue=function(e){var n=Number(e);return this.ensureNumber(n)?n:(this.error="[CountUp] invalid start or end value: ".concat(e),null)},c.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},c.prototype.parse=function(e){var n=function(d){return d.replace(/([.,'Â  ])/g,"\\$1")},i=n(this.options.separator),s=n(this.options.decimal),l=e.replace(new RegExp(i,"g"),"").replace(new RegExp(s,"g"),".");return parseFloat(l)},c})();const j={class:"main-content"},Y={class:"row"},W={class:"col-sm-12 col-md-12 col-lg-12"},z={class:"modern-card"},J={class:"card-header-modern"},K={class:"card-body-modern"},Q={class:"stats-grid"},X={class:"stat-content"},Z={class:"stat-label"},tt={__name:"AdminDashboardStatistics",props:{stats:{type:Object,default:()=>({recordsSaved:0,totalUsers:0,dataPendingSync:0})}},setup(c){const e=c,n={recordsSaved:b(null),totalUsers:b(null),dataPendingSync:b(null)},i={title:"New Survey",icon:"bi bi-plus-square",route:"baseline-new"},s=d=>new Intl.NumberFormat("en-US").format(d),l=[{title:"Records Saved",key:"recordsSaved",icon:"bi bi-database-fill-check",gradient:"from-emerald-500 to-teal-600",bgColor:"bg-emerald-50",iconColor:"text-emerald-600"},{title:"Total Users",key:"totalUsers",icon:"bi bi-people-fill",gradient:"from-blue-500 to-indigo-600",bgColor:"bg-blue-50",iconColor:"text-blue-600"},{title:"Data Pending Sync",key:"dataPendingSync",icon:"bi bi-cloud-arrow-up-fill",gradient:"from-amber-500 to-orange-600",bgColor:"bg-amber-50",iconColor:"text-amber-600"}];return U(()=>{l.forEach(d=>{const a=n[d.key].value;a&&new N(a,e.stats[d.key],{duration:2,separator:","}).start()})}),H(()=>e.stats,d=>{l.forEach(a=>{const r=n[a.key].value;r&&new N(r,d[a.key],{duration:2,separator:","}).start()})},{deep:!0}),(d,a)=>(y(),V(P,null,[a[3]||(a[3]=t("div",{class:"clearfix"},null,-1)),t("section",j,[t("div",Y,[t("div",W,[t("div",z,[t("div",J,[a[1]||(a[1]=t("div",{class:"header-content"},[t("h5",{class:"header-title"},[t("i",{class:"bi bi-graph-up-arrow me-2"}),k(" Dashboard Statistics ")]),t("p",{class:"header-subtitle"},"Real-time overview of your data")],-1)),A(u(R),{href:d.route(i.route),class:"btn-modern"},{default:$(()=>[t("i",{class:x([i.icon,"me-2"])},null,2),a[0]||(a[0]=k(" New Input ",-1))]),_:1},8,["href"])]),t("div",K,[t("div",Q,[(y(),V(P,null,M(l,(r,f)=>t("div",{key:f,class:"stat-card"},[t("div",{class:x(["stat-icon-wrapper",r.bgColor])},[t("i",{class:x([[r.icon,r.iconColor],"stat-icon"])},null,2)],2),t("div",X,[t("p",Z,p(r.title),1),t("h3",{class:"stat-value",ref_for:!0,ref:h=>n[r.key].value=h},p(s(e.stats[r.key])),513),t("div",{class:x(["stat-badge",`bg-gradient-to-r ${r.gradient}`])},[...a[2]||(a[2]=[t("span",{class:"badge-text"},"Active",-1)])],2)])])),64))])])])])])])],64))}},st=O(tt,[["__scopeId","data-v-955d4305"]]);class et{constructor(){this.watchId=null,this.listeners=new Set,this.currentPosition=null,this.error=null}startTracking(e={}){if(!navigator.geolocation)return this.error=new Error("Geolocation is not supported by this browser."),this.notifyListeners(),!1;const n={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};try{return this.watchId=navigator.geolocation.watchPosition(i=>{this.currentPosition={latitude:i.coords.latitude,longitude:i.coords.longitude,accuracy:i.coords.accuracy,timestamp:i.timestamp},this.error=null,this.notifyListeners()},i=>{this.error=i,this.notifyListeners()},{...n,...e}),!0}catch(i){return this.error=i,this.notifyListeners(),!1}}stopTracking(){return this.watchId!==null?(navigator.geolocation.clearWatch(this.watchId),this.watchId=null,!0):!1}async getCurrentPosition(e={}){if(!navigator.geolocation)throw new Error("Geolocation is not supported by this browser.");const n={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};return new Promise((i,s)=>{navigator.geolocation.getCurrentPosition(l=>{i({latitude:l.coords.latitude,longitude:l.coords.longitude,accuracy:l.coords.accuracy,timestamp:l.timestamp})},s,{...n,...e})})}subscribe(e){return this.listeners.add(e),(this.currentPosition||this.error)&&e({position:this.currentPosition,error:this.error}),()=>this.unsubscribe(e)}unsubscribe(e){this.listeners.delete(e)}notifyListeners(){this.listeners.forEach(e=>{e({position:this.currentPosition,error:this.error})})}}const F=new et;function nt(c={}){const e=b(null),n=b(null),i=b(!1),s=F.subscribe(({position:r,error:f})=>{e.value=r,n.value=f}),l=()=>{const r=F.startTracking(c);return i.value=r,r},d=()=>{const r=F.stopTracking();return i.value=!r,r},a=async()=>{try{return e.value=await F.getCurrentPosition(c),n.value=null,e.value}catch(r){throw n.value=r,r}};return I(()=>{s(),i.value&&d()}),{position:e,error:n,isTracking:i,startTracking:l,stopTracking:d,getCurrentPosition:a}}function it(){const c=b(null),e=b([]),n=b(null),i=b(!1),s=b(null),l=()=>{if(!navigator.geolocation)return n.value="Geolocation is not supported by this browser.",!1;try{return i.value=!0,s.value=navigator.geolocation.watchPosition(h=>{const m={latitude:h.coords.latitude,longitude:h.coords.longitude,accuracy:h.coords.accuracy,speed:h.coords.speed,timestamp:new Date().toISOString()};c.value=m,e.value.push(m),n.value=null},h=>{n.value=h.message,i.value=!1},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}),!0}catch(h){return n.value=h.message,i.value=!1,!1}},d=()=>s.value?(navigator.geolocation.clearWatch(s.value),s.value=null,i.value=!1,!0):!1,a=(h,m,g,o)=>{const S=h*Math.PI/180,_=g*Math.PI/180,T=(g-h)*Math.PI/180,v=(o-m)*Math.PI/180,E=Math.sin(T/2)*Math.sin(T/2)+Math.cos(S)*Math.cos(_)*Math.sin(v/2)*Math.sin(v/2);return 6371e3*(2*Math.atan2(Math.sqrt(E),Math.sqrt(1-E)))},r=()=>{if(e.value.length<2)return 0;let h=0;for(let m=1;m<e.value.length;m++){const g=e.value[m-1],o=e.value[m];h+=a(g.latitude,g.longitude,o.latitude,o.longitude)}return h},f=()=>{e.value=[]};return I(()=>{i.value&&d()}),{currentLocation:c,locationHistory:e,error:n,isTracking:i,startTracking:l,stopTracking:d,getTotalDistance:r,clearHistory:f}}const ot={class:"location-tracker card"},at={class:"card-header d-flex justify-content-between align-items-center"},rt={class:"btn-group"},lt=["disabled"],ut=["disabled"],dt=["disabled"],ct={class:"card-body"},ht={key:0,class:"alert alert-danger"},pt={class:"current-location mb-3"},mt={class:"row g-2"},gt={class:"col-md-3"},ft={class:"p-2 border rounded"},vt={class:"col-md-3"},bt={class:"p-2 border rounded"},yt={class:"col-md-3"},wt={class:"p-2 border rounded"},Vt={class:"col-md-3"},_t={class:"p-2 border rounded"},kt={class:"tracking-stats mb-3"},St={class:"row g-2"},xt={class:"col-md-4"},Tt={class:"p-2 border rounded"},Et={class:"col-md-4"},Ft={class:"p-2 border rounded"},At={class:"col-md-4"},Ct={class:"p-2 border rounded"},Dt={key:1,class:"location-history"},Pt={class:"table-responsive"},Lt={class:"table table-sm"},Nt={__name:"LocationTracker",setup(c){const{currentLocation:e,locationHistory:n,error:i,isTracking:s,startTracking:l,stopTracking:d,getTotalDistance:a,clearHistory:r}=it(),f=L(()=>{const g=a();return g>=1e3?`${(g/1e3).toFixed(2)} km`:`${Math.round(g)} m`}),h=L(()=>{var o;return(o=e.value)!=null&&o.speed?`${(e.value.speed*3.6).toFixed(1)} km/h`:"N/A"}),m=g=>(g==null?void 0:g.toFixed(6))??"N/A";return(g,o)=>{var w,S,_,T;return y(),V("div",ot,[t("div",at,[o[6]||(o[6]=t("h5",{class:"mb-0"},"Live Location Tracker",-1)),t("div",rt,[t("button",{onClick:o[0]||(o[0]=(...v)=>u(l)&&u(l)(...v)),class:x(["btn btn-sm",u(s)?"btn-success":"btn-outline-success"]),disabled:u(s)},[...o[3]||(o[3]=[t("i",{class:"bi bi-play-fill"},null,-1),k(" Start ",-1)])],10,lt),t("button",{onClick:o[1]||(o[1]=(...v)=>u(d)&&u(d)(...v)),class:"btn btn-sm btn-outline-danger",disabled:!u(s)},[...o[4]||(o[4]=[t("i",{class:"bi bi-stop-fill"},null,-1),k(" Stop ",-1)])],8,ut),t("button",{onClick:o[2]||(o[2]=(...v)=>u(r)&&u(r)(...v)),class:"btn btn-sm btn-outline-secondary",disabled:u(n).length===0},[...o[5]||(o[5]=[t("i",{class:"bi bi-trash"},null,-1),k(" Clear ",-1)])],8,dt)])]),t("div",ct,[u(i)?(y(),V("div",ht,p(u(i)),1)):C("",!0),t("div",pt,[o[11]||(o[11]=t("h6",null,"Current Location:",-1)),t("div",mt,[t("div",gt,[t("div",ft,[o[7]||(o[7]=t("small",{class:"text-muted"},"Latitude",-1)),t("div",null,p(m((w=u(e))==null?void 0:w.latitude)),1)])]),t("div",vt,[t("div",bt,[o[8]||(o[8]=t("small",{class:"text-muted"},"Longitude",-1)),t("div",null,p(m((S=u(e))==null?void 0:S.longitude)),1)])]),t("div",yt,[t("div",wt,[o[9]||(o[9]=t("small",{class:"text-muted"},"Speed",-1)),t("div",null,p(h.value),1)])]),t("div",Vt,[t("div",_t,[o[10]||(o[10]=t("small",{class:"text-muted"},"Accuracy",-1)),t("div",null,p(((T=(_=u(e))==null?void 0:_.accuracy)==null?void 0:T.toFixed(1))??"N/A")+" m",1)])])])]),t("div",kt,[o[15]||(o[15]=t("h6",null,"Tracking Statistics:",-1)),t("div",St,[t("div",xt,[t("div",Tt,[o[12]||(o[12]=t("small",{class:"text-muted"},"Total Distance",-1)),t("div",null,p(f.value),1)])]),t("div",Et,[t("div",Ft,[o[13]||(o[13]=t("small",{class:"text-muted"},"Points Recorded",-1)),t("div",null,p(u(n).length),1)])]),t("div",At,[t("div",Ct,[o[14]||(o[14]=t("small",{class:"text-muted"},"Status",-1)),t("div",null,[t("span",{class:x(["badge",u(s)?"bg-success":"bg-secondary"])},p(u(s)?"Tracking":"Stopped"),3)])])])])]),u(n).length>0?(y(),V("div",Dt,[o[17]||(o[17]=t("h6",null,"Location History:",-1)),t("div",Pt,[t("table",Lt,[o[16]||(o[16]=t("thead",null,[t("tr",null,[t("th",null,"Time"),t("th",null,"Latitude"),t("th",null,"Longitude"),t("th",null,"Speed"),t("th",null,"Accuracy")])],-1)),t("tbody",null,[(y(!0),V(P,null,M(u(n).slice().reverse(),(v,E)=>(y(),V("tr",{key:E},[t("td",null,p(new Date(v.timestamp).toLocaleTimeString()),1),t("td",null,p(m(v.latitude)),1),t("td",null,p(m(v.longitude)),1),t("td",null,p(v.speed?(v.speed*3.6).toFixed(1)+" km/h":"N/A"),1),t("td",null,p(v.accuracy.toFixed(1))+" m",1)]))),128))])])])])):C("",!0)])])}}},$t=O(Nt,[["__scopeId","data-v-cc5194ed"]]),Mt={key:0},It={key:1,class:"text-danger"},Ot=["disabled"],Ut=["disabled"],Ht={class:"row"},Rt={class:"col-12"},Yt={__name:"AdminDashboard",props:{stats:{type:Object,default:()=>({recordsSaved:0,totalUsers:0,dataPendingSync:0})}},setup(c){const{position:e,error:n,isTracking:i,startTracking:s,stopTracking:l}=nt();return(d,a)=>(y(),B(q,null,{default:$(()=>[A(u(G),{title:"Dashboard "}),a[4]||(a[4]=t("div",{class:"row"},[t("div",{class:"col-lg-12"},[t("h5",{class:"mt-4 fw-400"},"Admin Dashboard"),t("hr")])],-1)),a[5]||(a[5]=t("div",{class:"clearfix"},null,-1)),A(st,{stats:c.stats},null,8,["stats"]),t("div",null,[u(e)?(y(),V("div",Mt,[k(" Latitude: "+p(u(e).latitude),1),a[2]||(a[2]=t("br",null,null,-1)),k(" Longitude: "+p(u(e).longitude),1),a[3]||(a[3]=t("br",null,null,-1)),k(" Accuracy: "+p(u(e).accuracy)+"m ",1)])):C("",!0),u(n)?(y(),V("div",It,p(u(n).message),1)):C("",!0),t("button",{onClick:a[0]||(a[0]=(...r)=>u(s)&&u(s)(...r)),disabled:u(i)}," Start Tracking ",8,Ot),t("button",{onClick:a[1]||(a[1]=(...r)=>u(l)&&u(l)(...r)),disabled:!u(i)}," Stop Tracking ",8,Ut)]),t("div",Ht,[t("div",Rt,[A($t)])])]),_:1}))}};export{Yt as default};
