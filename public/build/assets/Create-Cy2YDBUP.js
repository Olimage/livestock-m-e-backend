import{p as S,r as F,d as N,g as y,j as C,b as s,u as a,k as D,q as E,s as p,v as k,t as i,c as d,i as r,F as f,h as _,x as U,l as L,f as M}from"./app-CRduYzfZ.js";import{B as j}from"./BeLayout-CF6fqCw2.js";import{_ as A}from"./Includes-C6kNh0Lp.js";const T={class:"row"},$={class:"col-lg-8"},q={class:"card"},P={class:"card-body"},R={class:"mb-3"},z={class:"text-danger"},G={class:"mb-3"},H={class:"text-danger"},J={class:"mb-3"},K=["value"],O={class:"text-danger"},Q={class:"mb-3"},W=["onUpdate:modelValue","onChange"],X=["value"],Y={class:"text-danger"},Z={class:"d-flex gap-2"},I=["disabled"],ee={__name:"Create",props:{roles:Array,departments:Array},setup(V){var v,b,g,h;const c=V,t=S({full_name:"",email:"",role:((b=(v=c.roles)==null?void 0:v[0])==null?void 0:b.slug)??((h=(g=c.roles)==null?void 0:g[0])==null?void 0:h.name)??"",department_ids:[]}),m=F([]);m.value=[c.departments||[]];async function x(o){if(!o)return[];const e=await fetch(`/departments/${o}/children`,{credentials:"same-origin"});return e.ok?e.json():[]}async function w(o,e){t.department_ids=t.department_ids.slice(0,o),e&&(t.department_ids[o]=e),m.value=m.value.slice(0,o+1);const l=await x(e);l&&l.length>0&&m.value.push(l)}function B(){if(!t.department_ids||t.department_ids.length===0){t.setError("department_ids","Please select a department");return}t.post(route("users.store"),{onSuccess:()=>{}})}return(o,e)=>(r(),N(j,null,{default:y(()=>[C(a(D),{title:"Create User"}),s("div",T,[s("div",$,[e[9]||(e[9]=s("h5",{class:"mt-4"},"Create User",-1)),e[10]||(e[10]=s("hr",null,null,-1)),s("div",q,[s("div",P,[s("form",{onSubmit:E(B,["prevent"])},[s("div",R,[e[3]||(e[3]=s("label",{class:"form-label"},"Full name",-1)),p(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a(t).full_name=l),type:"text",class:"form-control"},null,512),[[k,a(t).full_name]]),s("small",z,i(a(t).errors.full_name),1)]),s("div",G,[e[4]||(e[4]=s("label",{class:"form-label"},"Email",-1)),p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a(t).email=l),type:"email",class:"form-control"},null,512),[[k,a(t).email]]),s("small",H,i(a(t).errors.email),1)]),s("div",J,[e[5]||(e[5]=s("label",{class:"form-label"},"Role",-1)),p(s("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>a(t).role=l),class:"form-select"},[(r(!0),d(f,null,_(c.roles,l=>(r(),d("option",{key:l.id,value:l.slug??l.name},i(l.name),9,K))),128))],512),[[U,a(t).role]]),s("small",O,i(a(t).errors.role),1)]),s("div",Q,[e[7]||(e[7]=s("label",{class:"form-label"},"Department (choose path)",-1)),(r(!0),d(f,null,_(m.value,(l,u)=>(r(),d("div",{key:u,class:"mb-2"},[p(s("select",{class:"form-select","onUpdate:modelValue":n=>a(t).department_ids[u]=n,onChange:n=>w(u,Number(a(t).department_ids[u])||null)},[e[6]||(e[6]=s("option",{value:null},"-- Select --",-1)),(r(!0),d(f,null,_(l,n=>(r(),d("option",{key:n.id,value:n.id},i(n.name),9,X))),128))],40,W),[[U,a(t).department_ids[u]]])]))),128)),s("small",Y,i(a(t).errors.department_ids),1)]),s("div",Z,[s("button",{type:"submit",class:"btn btn-success",disabled:a(t).processing},"Create User",8,I),C(a(L),{href:o.route("users.index"),class:"btn btn-outline-secondary"},{default:y(()=>[...e[8]||(e[8]=[M("Cancel",-1)])]),_:1},8,["href"])])],32)])])])])]),_:1}))}},ae=A(ee,[["__scopeId","data-v-fe5a8277"]]);export{ae as default};
